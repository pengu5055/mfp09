\documentclass[a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[slovene]{babel}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage[nottoc]{tocbibind}
\usepackage{minted}
\usepackage{listings}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{amsmath}
\usepackage{ dsfont }
\usepackage{siunitx}
\usepackage{multimedia}
\usepackage[table,xcdraw]{xcolor}
\setlength\parindent{0pt}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\newcommand{\ddd}{\mathrm{d}}
\newcommand\myworries[1]{\textcolor{red}{#1}}
\newcommand{\Dd}[3][{}]{\frac{\ddd^{#1} #2}{\ddd #3^{#1}}}
\newcommand{\Pd}[3][{}]{\frac{\partial^{#1} #2}{\partial #3^{#1}}}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\lstset{style=mystyle}

\begin{document}
\begin{titlepage}
    \begin{center}
        \includegraphics[]{logo.png}
        \vspace*{3cm}
        
        \Huge
        \textbf{Spektralne metode za začetne probleme PDE}
        
        \vspace{0.5cm}
        \large
        9. naloga pri Matematično-fizikalnem praktikumu

        \vspace{4.5cm}
        
        \textbf{Avtor:} Marko Urbanč (28191096)\ \\
        \textbf{Predavatelj:} prof. dr. Borut Paul Kerševan\ \\
        
        \vspace{2.8cm}
        
        \large
        1.9.2023
    \end{center}
\end{titlepage}
\tableofcontents
\newpage
\section{Uvod}
Parcialne diferencialne enačbe (PDE) lahko rešujemo na več različnih načinov.
Glavna razlika je v tem, kako diskretiziramo prostor in čas. V tej nalogi bomo 
reševali PDE z spektralnimi metodami.(Drugo možnost; diferenčne metode, bomo 
obravnavali v naslednji nalogi.) Pri spektralnih metodah diskretiziramo prostor s
tem, začetni pogoj izrazimo z nekim naborom baznih funkcij in nato iščemo rešitev
tako, da računamo, kako se koeficienti teh baznih funkcij spreminjajo s časom.
V tej nalogi bomo preizkusili reševanje preko Fourierove metode in metode končnih
elementov s kubičnimi B-zlepki.\\

\subsection{Fourierova metoda}
Fizikalno gledano rešujemo enodimenzionalno toplotno enačbo, torej difuzijsko enačbo,
v homogeni neskončni plasti, s končno debelino $a$, brez izvirov in ponorov toplote.

\begin{equation}
    D\Pd[2]{T}{x} = \Pd{T}{t}\quad 0\leq x \leq a,\quad D=\frac{\lambda}{\rho c}\>.
    \label{eq:1}
\end{equation}

Če Temperaturo $T(x, y)$ izrazimo kot Fourierovo vrsto dobimo

\begin{equation}
    T(x, t) = \sum_{k=0}^{N-1}{\hat{T}_k(t)\exp{\left(\frac{-2\pi i k x}{a}\right)}}\>. 
\end{equation}

Torej se PDE (\ref{eq:1}) zdaj zapiše kot

\begin{equation}
    \sum_{k=0}^{N-1}{\left(-\frac{4\pi^2 k^2 D}{a^2}\right)\hat{T}_k(t)\exp{\left(-\frac{2\pi i k x}{a}\right)}} = 
    \sum_{k=0}^{N-1}{\left(\frac{\ddd \hat{T}_k(t)}{\ddd t}\right)\exp{\left(-\frac{2\pi i k x}{a}\right)}}\>.
\end{equation}

Torej se naša naloga prevede na iskanje koeficientov $\hat{T}_k(t)$, ki jih dobimo preko
\textbf{evolucijske enačbe}
\begin{equation}
    \frac{\ddd \hat{T}_k(t)}{\ddd t} = -\frac{4\pi^2 k^2 D}{a^2}\hat{T}_k(t)\>.
    \label{eq:2}
\end{equation}

Pogosto se uporabi spektralno reprezentacijo za krajevni odvod, časovni korak pa naredimo
z neko ekspliticitno metodo. V našem primeru bomo uporabili \textbf{Eulerjevo metodo}.

\begin{equation}
    \hat{T}_k(t+k) = \hat{T}_k(t) + \frac{4\pi^2 k^2 D}{a^2}\hat{T}_k(t)k\>.
    \label{eq:3}
\end{equation}

Reprezentacijo $T(x, y)$ v običajnem prostoru dobimo z obratno Fourierovo transformacijo. Enačba
(\ref{eq:2}) ima analitično rešitev

\begin{equation}
    \hat{T}_k(t) = \hat{T}_k(0)\exp{\left(-\frac{4\pi^2 k^2 D}{a^2}t\right)}\>.
    \label{eq:4}
\end{equation}

To bo koristno za preverjanje numeričnih metod.\\
\subsection{Metoda končnih elementov}
Pri razvoju $T(x,y)$ nismo omejeni samo na trigonometrične funkcije. Lahko uporabimo tudi
poljubne druge funkcije. V našem primeru bomo uporabili kubične B-zlepke. To so funkcije
oblike

\begin{equation}
    B_{i, k}(x) = \frac{x-x_i}{x_{i+k}-x_i}B_{i, k-1}(x) + \frac{x_{i+k+1}-x}{x_{i+k+1}-x_{i+1}}B_{i+1, k-1}(x)\>.
\end{equation}

Začetni pogoj bomo izrazili kot linearno kombinacijo teh funkcij in nato iščemo rešitev
v obliki

\begin{equation}
    T(x, t) = \sum_{i=-1}^{N+1}{c_k(t)B_{i, 3}(x)}\>.
\end{equation}

Tako zasnujemo metodo končnih elementov, s kolokacijskim pogojem. To pomeni, da se začetni
pogoj mora ujemati z rešitvijo na nekem končnem številu točk. Podobno kot pri Fourierovi metodi
vstavimo razvoj v PDE in dobimo sistem enačb za koeficiente $\hat{T}_i(t)$

\begin{equation}
    \sum_{i=-1}^{N+1}{D c_k(t)B_{i, 3}(x)} = 
    \sum_{i=-1}^{N+1}{\left(\frac{\partial c_k(t)}{\partial t}\right)B_{i, 3}(x)}\>.
\end{equation}

Uporabimo lastnosti B-zlepkov in dobimo sistem diferencialnih enačb za koeficiente $c_k(t)$

\begin{equation}
    \dot{c}_{j-1}(t) + 4\dot{c}_{j}(t) + \dot{c}_{j+1}(t) = \frac{6D}{h^2}(c_{j-1}(t) - 2c_j(t) + c_{j+1}(t))\>,
\end{equation}

kjer je $h$ razdalja med točkami, ki smo jih izbrali za kolokacijski pogoj. Iz robnega pogoja pri $x=0$
ugotovimo, da je $c_{-1} = -4c_0-c_1$. Podobno iz robnega pogoja pri $x=a$ sledi $c_0 = C_N = 0$ in $c_{-1} = -c_1$
ter $c_{N-1} = -c_{N+1}$. Reševanje smo torej prevedli na reševanje matričnega sistema

\begin{equation}
    \mathbf{A} \frac{\ddd \vec{c}}{\ddd t} = \mathbf{B}\vec{c}\>,
\end{equation}

kjer je $\mathbf{A}$ tridiagonalna matrika z $4$ na diagonali in $1$ na pod in nad diagonalo

\begin{equation}
    \mathbf{A}=\begin{bmatrix}
        4 & 1 & 0 & \cdots & 0 & 0 & 0\\
        1 & 4 & 1 & \cdots & 0 & 0 & 0\\
        0 & 1 & 4 & \cdots & 0 & 0 & 0\\
        \vdots & \vdots & \vdots & \ddots & \vdots & \vdots & \vdots\\
        0 & 0 & 0 & \cdots & 4 & 1 & 0\\
        0 & 0 & 0 & \cdots & 1 & 4 & 1\\
        0 & 0 & 0 & \cdots & 0 & 1 & 4\\
    \end{bmatrix}\>,
\end{equation}

$\mathbf{B}$ tridiagonalna matrika z $-2$ na diagonali in $1$ na pod in nad diagonalo pomnožena z $6D/h^2$

\begin{equation}
    \mathbf{B}=\frac{6D}{h^2}\begin{bmatrix}
        -2 & 1 & 0 & \cdots & 0 & 0 & 0\\
        1 & -2 & 1 & \cdots & 0 & 0 & 0\\
        0 & 1 & -2 & \cdots & 0 & 0 & 0\\
        \vdots & \vdots & \vdots & \ddots & \vdots & \vdots & \vdots\\
        0 & 0 & 0 & \cdots & -2 & 1 & 0\\
        0 & 0 & 0 & \cdots & 1 & -2 & 1\\
        0 & 0 & 0 & \cdots & 0 & 1 & -2\\
    \end{bmatrix}\>,
\end{equation}

in $\vec{c}$ vektor koeficientov $c_k(t)$. Začetni pogoj za PDE je $T(x, 0) = f(x)$, torej je začetni približek
za kolokacijsko aproksimacijo

\begin{equation}
    \mathbf{A}\vec{c} = \vec{f}\>,
\end{equation}

kjer je $\vec{f}$ vektor $f(x_i)$. To zdaj rešujemo z neko eksplitično metodo. V našem primeru bomo uporabili
\textbf{Implicitno Eulerjevo metodo} zaradi njene stabilnosti. To pomeni, da za časovni korak $k$ velja

\begin{equation}
    \mathbf{A}\frac{\vec{c}_{k+1}-\vec{c}_k}{\Delta t} = \mathbf{B}\vec{c}_{k+1}\>.
\end{equation}

\section{Naloga}

\section{Opis reševanja}

\section{Rezultati}


\section{Komentarji in izboljšave}

\newpage
\bibliographystyle{unsrt}
\bibliography{sources}
\end{document}
